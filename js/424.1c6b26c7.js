"use strict";(self["webpackChunkhowshonginn"]=self["webpackChunkhowshonginn"]||[]).push([[424],{8924:function(e,a,o){o.d(a,{Z:function(){return u}});var n=o(6252),l=o(3577),t=o(2201),r=o(2262);const s={class:"flex gap-x-2"},i={key:1};var d={__name:"BreadCrumbComponent",setup(e){const a=(0,t.yj)(),o=(0,r.iH)([]);return(0,n.bv)((()=>{o.value=[...a.meta.breadcrumb]})),(e,a)=>{const t=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("ul",s,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.value,((e,a)=>((0,n.wg)(),(0,n.iD)("li",{class:(0,l.C_)({"before:mr-2 before:text-black before:content-[>] ":a>0}),key:e.name},[e.link?((0,n.wg)(),(0,n.j4)(t,{key:0,to:e.link,class:"text-primary-dark"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.name),1)])),_:2},1032,["to"])):((0,n.wg)(),(0,n.iD)("span",i,(0,l.zw)(e.name),1))],2)))),128))])}}};const c=d;var u=c},5424:function(e,a,o){o.r(a),o.d(a,{default:function(){return Y}});var n=o(6252),l=o(2262),t=o(3577),r=o(9963),s=o(8924),i=o(4341),d=o(8326),c=o(9669),u=o.n(c),p=o(3621);const m={class:"py-20 md:py-34"},w={class:"container"},b={class:"flex flex-wrap gap-y-8 md:-mx-4"},f={class:"w-full lg:w-1/2 lg:px-4"},k={class:"group relative mx-auto aspect-1 w-2/3 overflow-hidden rounded-full ring-4 ring-primary-dark"},y=["src"],g={class:"text-2xl tracking-widest text-white"},x=(0,n.Uk)("變更大頭照"),v={class:"flex w-full flex-col lg:w-1/2 lg:px-4"},h={class:"mb-auto"},_=(0,n._)("label",{for:"email",class:"mb-2 block text-lg font-bold text-primary-dark lg:text-xl"},"Email",-1),P=["value"],C={for:"nickname",class:"mb-2 block text-lg font-bold text-primary-dark lg:text-xl"},V=(0,n.Uk)("暱稱"),I=(0,n._)("label",{for:"password",class:"mb-2 block text-lg font-bold text-primary-dark lg:text-xl"},"密碼",-1),U={class:"flex justify-center"},j=["disabled"],S={key:0},z=(0,n._)("label",{for:"url",class:"mb-2 block text-xl font-bold text-primary-dark"},"圖片 URL",-1),D={key:1},H=(0,n._)("label",{for:"oldPassword",class:"mb-2 block text-xl font-bold text-primary-dark"},"舊密碼",-1),q=(0,n._)("label",{for:"newPassword",class:"mb-2 block text-xl font-bold text-primary-dark"},"新密碼",-1),A=(0,n._)("label",{for:"newPasswordCheck",class:"mb-2 block text-xl font-bold text-primary-dark"},"確認新密碼",-1);var B={__name:"SettingView",setup(e){const a=(0,d.o)(),c=(0,l.iH)(null),B=(0,l.qj)({}),L=(0,l.iH)(!1),Y=(0,l.iH)("");let K=(0,l.iH)("pic");const $=u().create({baseURL:"https://8ojgh9.deta.dev"}),E=(0,l.qj)({nickname:"",pic:"",oldPassword:"",newPassword:"",newPasswordCheck:""}),F=(0,l.qj)({nickname:{modified:!1,newValue:""},pic:{modified:!1,newValue:""},password:{modified:!1,newValue:""}}),M=(0,n.Fl)((()=>""!==F.pic.newValue?F.pic.newValue:""!==E.pic?E.pic:""!==a.userInfo.pic?a.userInfo.pic:o(6741))),W=(0,n.Fl)((()=>Object.values(F).every((e=>!e.modified))));function Z(){E.nickname!==B.nickname?(F.nickname.modified=!0,F.nickname.newValue=E.nickname):(F.nickname.modified=!1,Y.value="")}function O(){K.value="password",J()}function R(){K.value="pic",J()}function T(){if(c.value.value.length>0){const e=E.newPassword===E.newPasswordCheck;e?(c.value.classList.remove("bg-danger"),document.querySelector("#passwordConfirm").removeAttribute("disabled")):(c.value.classList.add("bg-danger"),document.querySelector("#passwordConfirm").setAttribute("disabled",!0))}}function G(){F.nickname.modified&&$.get(`/user?nickname=${F.nickname.newValue}`).then((e=>e.data.length>0?Y.value="false":Y.value="true")).catch((()=>console.error("API 好像掛了，真是抱歉!!!")))}function J(){L.value=!0,a.toggleMask(!0,!0,!1)}function N(){L.value=!1,a.toggleMask(!1),Q()}function Q(){E.pic="",E.oldPassword="",E.newPassword="",E.newPasswordCheck=""}function X(){"pic"===K.value?(F.pic.newValue=E.pic,F.pic.modified=!0,N()):$.get(`/user?id=${a.userInfo.id}&password=${E.oldPassword}`).then((e=>{e.data.length>0?(F.password.newValue=E.newPassword,F.password.modified=!0,N()):(E.oldPassword="",(0,p.Yz)({title:"溫馨提醒",description:"舊密碼好像有錯誤，請再試一次"},{type:"warning",position:"top-center",timeout:3e3,toastBackgroundColor:"#D28226",showIcon:"true",transition:"zoom"}))})).catch((()=>console.error("API 好像掛了，真是抱歉!!!")))}function ee(){if(0===F.nickname.newValue.length)(0,p.Yz)({title:"暱稱不可空白"},{type:"warning",position:"top-center",timeout:3e3,toastBackgroundColor:"#E3A864",showIcon:"true",transition:"zoom"});else{const e={};F.nickname.modified&&(e.nickname=F.nickname.newValue),F.pic.modified&&(e.pic=F.pic.newValue),F.password.modified&&(e.password=F.password.newValue),$.patch(`/user/${a.userInfo.id}`,e).then((()=>{Object.entries(e).forEach((e=>a.userInfo[e[0]]=e[1])),"session"===a.userInfo.mode?a.userInfoToSessionStorage():a.userInfoToLocalStorage(),(0,p.Yz)({title:"修改成功"},{type:"success",position:"top-center",timeout:3e3,toastBackgroundColor:"#408560",showIcon:"true",transition:"zoom"})})).catch((()=>console.error("API 好像掛了，真是抱歉!!!")))}}return(0,n.bv)((()=>{B.email=a.userInfo.email,B.nickname=a.userInfo.nickname,B.pic=a.userInfo.pic,E.nickname=a.userInfo.nickname})),(e,a)=>{const o=(0,n.up)("font-awesome-icon");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",m,[(0,n._)("div",w,[(0,n.Wm)((0,l.SU)(s.Z),{class:"mb-10"}),(0,n._)("div",b,[(0,n._)("div",f,[(0,n._)("div",k,[(0,n._)("img",{src:(0,l.SU)(M),alt:"大頭照",class:"aspect-1 w-full object-cover"},null,8,y),(0,n._)("div",{class:"invisible absolute inset-0 flex aspect-1 w-full cursor-pointer items-center justify-center rounded bg-black/[0.5] opacity-0 duration-300 group-hover:visible group-hover:opacity-100",onClick:R},[(0,n._)("span",g,[(0,n.Wm)(o,{icon:"fa-solid fa-image",class:"mr-2"}),x])])])]),(0,n._)("div",v,[(0,n._)("div",h,[_,(0,n._)("input",{type:"text",id:"email",class:"pointer-events-none mb-6 w-full rounded border border-black py-1 px-4 read-only:bg-gray-200 read-only:text-gray-500",value:B.email,readonly:""},null,8,P),(0,n._)("label",C,[V,(0,n.wy)((0,n._)("span",{class:(0,t.C_)(["ml-2 text-sm","true"===Y.value?"text-primary-dark":"text-danger-dark"])},[(0,n.Wm)(o,{icon:["fa-solid","true"===Y.value?"fa-circle-check":"fa-circle-xmark"],class:"mr-1"},null,8,["icon"]),(0,n.Uk)((0,t.zw)("true"===Y.value?"可使用":"已被使用"),1)],2),[[r.F8,""!==Y.value]])]),(0,n.wy)((0,n._)("input",{type:"text",id:"nickname",class:"mb-6 w-full rounded border border-black py-1 px-4","onUpdate:modelValue":a[0]||(a[0]=e=>E.nickname=e),onKeyup:Z,onBlur:G},null,544),[[r.nr,E.nickname,void 0,{trim:!0}]]),I,(0,n._)("button",{type:"text",class:"btn btn-secondary",onClick:O}," 變更密碼 ")]),(0,n._)("div",U,[(0,n._)("button",{type:"button",class:"btn enabled:btn-primary btn-large mt-6 disabled:bg-gray-300 disabled:text-gray-600",onClick:ee,disabled:(0,l.SU)(W)}," 確認變更 ",8,j)])])])])]),L.value?((0,n.wg)(),(0,n.j4)((0,l.SU)(i.Z),{key:0,onCloseModal:N,class:"border-primary px-6"},{default:(0,n.w5)((()=>["pic"===(0,l.SU)(K)?((0,n.wg)(),(0,n.iD)("div",S,[z,(0,n.wy)((0,n._)("input",{type:"text",id:"url",class:"mb-4 w-full rounded border border-black py-1 px-4",placeholder:"請輸入圖片網址","onUpdate:modelValue":a[1]||(a[1]=e=>E.pic=e)},null,512),[[r.nr,E.pic,void 0,{trim:!0}]]),(0,n._)("button",{type:"button",class:"btn btn-primary relative left-1/2 -translate-x-1/2",onClick:X}," 確認 ")])):((0,n.wg)(),(0,n.iD)("div",D,[H,(0,n.wy)((0,n._)("input",{type:"password",id:"oldPassword",class:"mb-4 w-full rounded border border-black py-1 px-4",placeholder:"請輸入舊密碼","onUpdate:modelValue":a[2]||(a[2]=e=>E.oldPassword=e)},null,512),[[r.nr,E.oldPassword,void 0,{trim:!0}]]),q,(0,n.wy)((0,n._)("input",{type:"password",id:"newPassword",class:"mb-4 w-full rounded border border-black py-1 px-4",placeholder:"請輸入新密碼","onUpdate:modelValue":a[3]||(a[3]=e=>E.newPassword=e),onKeyup:T},null,544),[[r.nr,E.newPassword,void 0,{trim:!0}]]),A,(0,n.wy)((0,n._)("input",{type:"password",id:"newPasswordCheck",class:"mb-6 w-full rounded border border-black py-1 px-4",placeholder:"請再次確認新密碼",ref_key:"newPasswordCheck",ref:c,"onUpdate:modelValue":a[4]||(a[4]=e=>E.newPasswordCheck=e),onKeyup:T},null,544),[[r.nr,E.newPasswordCheck,void 0,{trim:!0}]]),(0,n._)("button",{type:"button",id:"passwordConfirm",class:"btn enabled:btn-primary relative left-1/2 -translate-x-1/2 disabled:bg-gray-300 disabled:text-gray-600",onClick:X,disabled:""}," 確認變更 ")]))])),_:1})):(0,n.kq)("",!0)],64)}}};const L=B;var Y=L}}]);
//# sourceMappingURL=424.1c6b26c7.js.map