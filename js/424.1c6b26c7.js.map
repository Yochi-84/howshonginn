{"version":3,"file":"js/424.1c6b26c7.js","mappings":"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","sources":["webpack://howshonginn/./src/components/BreadCrumbComponent.vue","webpack://howshonginn/./src/components/BreadCrumbComponent.vue?2b34","webpack://howshonginn/./src/views/SettingView.vue","webpack://howshonginn/./src/views/SettingView.vue?d08e"],"sourcesContent":["<template>\n  <ul class=\"flex gap-x-2\">\n    <li\n      :class=\"{\n        'before:mr-2 before:text-black before:content-[>] ': index > 0,\n      }\"\n      v-for=\"(item, index) of breadcrumb\"\n      :key=\"item.name\"\n    >\n      <router-link :to=\"item.link\" v-if=\"item.link\" class=\"text-primary-dark\">{{\n        item.name\n      }}</router-link>\n      <span v-else>{{ item.name }}</span>\n    </li>\n  </ul>\n</template>\n<script setup>\nimport { useRoute } from \"vue-router\";\nimport { ref, onMounted } from \"vue\";\n\nconst route = useRoute();\n\nconst breadcrumb = ref([]);\n\nonMounted(() => {\n  breadcrumb.value = [...route.meta.breadcrumb];\n});\n</script>\n","import script from \"./BreadCrumbComponent.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./BreadCrumbComponent.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n  <div class=\"py-20 md:py-34\">\r\n    <div class=\"container\">\r\n      <BreadCrumb class=\"mb-10\"></BreadCrumb>\r\n      <div class=\"flex flex-wrap gap-y-8 md:-mx-4\">\r\n        <div class=\"w-full lg:w-1/2 lg:px-4\">\r\n          <div\r\n            class=\"group relative mx-auto aspect-1 w-2/3 overflow-hidden rounded-full ring-4 ring-primary-dark\"\r\n          >\r\n            <img\r\n              :src=\"currentPic\"\r\n              alt=\"大頭照\"\r\n              class=\"aspect-1 w-full object-cover\"\r\n            />\r\n            <div\r\n              class=\"invisible absolute inset-0 flex aspect-1 w-full cursor-pointer items-center justify-center rounded bg-black/[0.5] opacity-0 duration-300 group-hover:visible group-hover:opacity-100\"\r\n              @click=\"changePicture\"\r\n            >\r\n              <span class=\"text-2xl tracking-widest text-white\"\r\n                ><font-awesome-icon\r\n                  icon=\"fa-solid fa-image\"\r\n                  class=\"mr-2\"\r\n                />變更大頭照</span\r\n              >\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"flex w-full flex-col lg:w-1/2 lg:px-4\">\r\n          <div class=\"mb-auto\">\r\n            <label\r\n              for=\"email\"\r\n              class=\"mb-2 block text-lg font-bold text-primary-dark lg:text-xl\"\r\n              >Email</label\r\n            >\r\n            <input\r\n              type=\"text\"\r\n              id=\"email\"\r\n              class=\"pointer-events-none mb-6 w-full rounded border border-black py-1 px-4 read-only:bg-gray-200 read-only:text-gray-500\"\r\n              :value=\"info.email\"\r\n              readonly\r\n            />\r\n            <label\r\n              for=\"nickname\"\r\n              class=\"mb-2 block text-lg font-bold text-primary-dark lg:text-xl\"\r\n              >暱稱<span\r\n                :class=\"[\r\n                  'ml-2 text-sm',\r\n                  nicknameStatus === 'true'\r\n                    ? 'text-primary-dark'\r\n                    : 'text-danger-dark',\r\n                ]\"\r\n                v-show=\"nicknameStatus !== ''\"\r\n                ><font-awesome-icon\r\n                  :icon=\"[\r\n                    'fa-solid',\r\n                    nicknameStatus === 'true'\r\n                      ? 'fa-circle-check'\r\n                      : 'fa-circle-xmark',\r\n                  ]\"\r\n                  class=\"mr-1\"\r\n                />{{ nicknameStatus === 'true' ? '可使用' : '已被使用' }}</span\r\n              ></label\r\n            >\r\n            <input\r\n              type=\"text\"\r\n              id=\"nickname\"\r\n              class=\"mb-6 w-full rounded border border-black py-1 px-4\"\r\n              v-model.trim=\"tempModifiedInfo.nickname\"\r\n              @keyup=\"changeNickname\"\r\n              @blur=\"checkRepeatNickname\"\r\n            />\r\n            <label\r\n              for=\"password\"\r\n              class=\"mb-2 block text-lg font-bold text-primary-dark lg:text-xl\"\r\n              >密碼</label\r\n            >\r\n            <button\r\n              type=\"text\"\r\n              class=\"btn btn-secondary\"\r\n              @click=\"changePassword\"\r\n            >\r\n              變更密碼\r\n            </button>\r\n          </div>\r\n          <div class=\"flex justify-center\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn enabled:btn-primary btn-large mt-6 disabled:bg-gray-300 disabled:text-gray-600\"\r\n              @click=\"modificationSubmit\"\r\n              :disabled=\"nothingModified\"\r\n            >\r\n              確認變更\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <ModalForm\r\n    @closeModal=\"closeModal\"\r\n    class=\"border-primary px-6\"\r\n    v-if=\"modalStatus\"\r\n  >\r\n    <!-- 變更大頭照 -->\r\n    <div v-if=\"modalContent === 'pic'\">\r\n      <label for=\"url\" class=\"mb-2 block text-xl font-bold text-primary-dark\"\r\n        >圖片 URL</label\r\n      >\r\n      <input\r\n        type=\"text\"\r\n        id=\"url\"\r\n        class=\"mb-4 w-full rounded border border-black py-1 px-4\"\r\n        placeholder=\"請輸入圖片網址\"\r\n        v-model.trim=\"tempModifiedInfo.pic\"\r\n      />\r\n      <button\r\n        type=\"button\"\r\n        class=\"btn btn-primary relative left-1/2 -translate-x-1/2\"\r\n        @click=\"modificationConfirm\"\r\n      >\r\n        確認\r\n      </button>\r\n    </div>\r\n    <!-- 變更密碼 -->\r\n    <div v-else>\r\n      <label\r\n        for=\"oldPassword\"\r\n        class=\"mb-2 block text-xl font-bold text-primary-dark\"\r\n        >舊密碼</label\r\n      >\r\n      <input\r\n        type=\"password\"\r\n        id=\"oldPassword\"\r\n        class=\"mb-4 w-full rounded border border-black py-1 px-4\"\r\n        placeholder=\"請輸入舊密碼\"\r\n        v-model.trim=\"tempModifiedInfo.oldPassword\"\r\n      />\r\n      <label\r\n        for=\"newPassword\"\r\n        class=\"mb-2 block text-xl font-bold text-primary-dark\"\r\n        >新密碼</label\r\n      >\r\n      <input\r\n        type=\"password\"\r\n        id=\"newPassword\"\r\n        class=\"mb-4 w-full rounded border border-black py-1 px-4\"\r\n        placeholder=\"請輸入新密碼\"\r\n        v-model.trim=\"tempModifiedInfo.newPassword\"\r\n        @keyup=\"checkPassword\"\r\n      />\r\n      <label\r\n        for=\"newPasswordCheck\"\r\n        class=\"mb-2 block text-xl font-bold text-primary-dark\"\r\n        >確認新密碼</label\r\n      >\r\n      <input\r\n        type=\"password\"\r\n        id=\"newPasswordCheck\"\r\n        class=\"mb-6 w-full rounded border border-black py-1 px-4\"\r\n        placeholder=\"請再次確認新密碼\"\r\n        ref=\"newPasswordCheck\"\r\n        v-model.trim=\"tempModifiedInfo.newPasswordCheck\"\r\n        @keyup=\"checkPassword\"\r\n      />\r\n      <button\r\n        type=\"button\"\r\n        id=\"passwordConfirm\"\r\n        class=\"btn enabled:btn-primary relative left-1/2 -translate-x-1/2 disabled:bg-gray-300 disabled:text-gray-600\"\r\n        @click=\"modificationConfirm\"\r\n        disabled\r\n      >\r\n        確認變更\r\n      </button>\r\n    </div>\r\n  </ModalForm>\r\n</template>\r\n<script setup>\r\nimport BreadCrumb from '@/components/BreadCrumbComponent';\r\nimport ModalForm from '@/components/ModalFormComponent';\r\nimport { ref, reactive, computed, onMounted } from 'vue';\r\nimport { useStore } from '@/stores/index';\r\nimport axios from 'axios';\r\nimport { createToast } from 'mosha-vue-toastify';\r\nimport 'mosha-vue-toastify/dist/style.css';\r\n\r\nconst store = useStore();\r\nconst newPasswordCheck = ref(null); // 確認新密碼的 input 欄位\r\nconst info = reactive({});\r\nconst modalStatus = ref(false);\r\nconst nicknameStatus = ref(''); // 確認新暱稱是否重複\r\nlet modalContent = ref('pic');\r\nconst api = axios.create({ baseURL: process.env.VUE_APP_API_PATH });\r\nconst tempModifiedInfo = reactive({\r\n  nickname: '',\r\n  pic: '',\r\n  oldPassword: '',\r\n  newPassword: '',\r\n  newPasswordCheck: '',\r\n});\r\n\r\nconst modifiedInfo = reactive({\r\n  nickname: {\r\n    modified: false,\r\n    newValue: '',\r\n  },\r\n  pic: {\r\n    modified: false,\r\n    newValue: '',\r\n  },\r\n  password: {\r\n    modified: false,\r\n    newValue: '',\r\n  },\r\n});\r\n\r\n// 顯示的圖片\r\nconst currentPic = computed(() => {\r\n  if (modifiedInfo.pic.newValue !== '') {\r\n    return modifiedInfo.pic.newValue;\r\n  } else if (tempModifiedInfo.pic !== '') {\r\n    return tempModifiedInfo.pic;\r\n  } else if (store.userInfo.pic !== '') {\r\n    return store.userInfo.pic;\r\n  } else {\r\n    return require('../assets/image/user_init.jpg');\r\n  }\r\n});\r\n\r\n// 有沒有更改資料，有改才能按送出\r\nconst nothingModified = computed(() =>\r\n  Object.values(modifiedInfo).every((item) => !item.modified)\r\n);\r\n\r\nfunction changeNickname() {\r\n  if (tempModifiedInfo.nickname !== info.nickname) {\r\n    modifiedInfo.nickname.modified = true;\r\n    modifiedInfo.nickname.newValue = tempModifiedInfo.nickname;\r\n  } else {\r\n    modifiedInfo.nickname.modified = false;\r\n    // 隱藏狀態\r\n    nicknameStatus.value = '';\r\n  }\r\n}\r\n\r\nfunction changePassword() {\r\n  modalContent.value = 'password';\r\n  showModal();\r\n}\r\n\r\nfunction changePicture() {\r\n  modalContent.value = 'pic';\r\n  showModal();\r\n}\r\n\r\n// 新密碼確認\r\nfunction checkPassword() {\r\n  if (newPasswordCheck.value.value.length > 0) {\r\n    const status =\r\n      tempModifiedInfo.newPassword === tempModifiedInfo.newPasswordCheck;\r\n    if (!status) {\r\n      newPasswordCheck.value.classList.add('bg-danger');\r\n      document.querySelector('#passwordConfirm').setAttribute('disabled', true);\r\n    } else {\r\n      newPasswordCheck.value.classList.remove('bg-danger');\r\n      document.querySelector('#passwordConfirm').removeAttribute('disabled');\r\n    }\r\n  }\r\n}\r\n\r\nfunction checkRepeatNickname() {\r\n  // 有改才送\r\n  if (modifiedInfo.nickname.modified) {\r\n    api\r\n      .get(`/user?nickname=${modifiedInfo.nickname.newValue}`)\r\n      .then((res) =>\r\n        res.data.length > 0\r\n          ? (nicknameStatus.value = 'false')\r\n          : (nicknameStatus.value = 'true')\r\n      )\r\n      .catch(() => console.error('API 好像掛了，真是抱歉!!!'));\r\n  }\r\n}\r\n\r\nfunction showModal() {\r\n  modalStatus.value = true;\r\n  store.toggleMask(true, true, false);\r\n}\r\n\r\nfunction closeModal() {\r\n  modalStatus.value = false;\r\n  store.toggleMask(false);\r\n  modalInit();\r\n}\r\n\r\n// 表單初始化\r\nfunction modalInit() {\r\n  tempModifiedInfo.pic = '';\r\n  tempModifiedInfo.oldPassword = '';\r\n  tempModifiedInfo.newPassword = '';\r\n  tempModifiedInfo.newPasswordCheck = '';\r\n}\r\n\r\nfunction modificationConfirm() {\r\n  if (modalContent.value === 'pic') {\r\n    modifiedInfo.pic.newValue = tempModifiedInfo.pic;\r\n    modifiedInfo.pic.modified = true;\r\n    closeModal();\r\n  } else {\r\n    api\r\n      .get(\r\n        `/user?id=${store.userInfo.id}&password=${tempModifiedInfo.oldPassword}`\r\n      )\r\n      .then((res) => {\r\n        if (res.data.length > 0) {\r\n          modifiedInfo.password.newValue = tempModifiedInfo.newPassword;\r\n          modifiedInfo.password.modified = true;\r\n          closeModal();\r\n        } else {\r\n          tempModifiedInfo.oldPassword = '';\r\n          createToast(\r\n            {\r\n              title: '溫馨提醒',\r\n              description: '舊密碼好像有錯誤，請再試一次',\r\n            },\r\n            {\r\n              type: 'warning',\r\n              position: 'top-center',\r\n              timeout: 3000,\r\n              toastBackgroundColor: '#D28226',\r\n              showIcon: 'true',\r\n              transition: 'zoom',\r\n            }\r\n          );\r\n        }\r\n      })\r\n      .catch(() => console.error('API 好像掛了，真是抱歉!!!'));\r\n  }\r\n}\r\n\r\nfunction modificationSubmit() {\r\n  if (modifiedInfo.nickname.newValue.length === 0) {\r\n    createToast(\r\n      {\r\n        title: '暱稱不可空白',\r\n      },\r\n      {\r\n        type: 'warning',\r\n        position: 'top-center',\r\n        timeout: 3000,\r\n        toastBackgroundColor: '#E3A864',\r\n        showIcon: 'true',\r\n        transition: 'zoom',\r\n      }\r\n    );\r\n  } else {\r\n    const modifiedValue = {};\r\n    if (modifiedInfo.nickname.modified)\r\n      modifiedValue.nickname = modifiedInfo.nickname.newValue;\r\n    if (modifiedInfo.pic.modified)\r\n      modifiedValue.pic = modifiedInfo.pic.newValue;\r\n    if (modifiedInfo.password.modified)\r\n      modifiedValue.password = modifiedInfo.password.newValue;\r\n    api\r\n      .patch(`/user/${store.userInfo.id}`, modifiedValue)\r\n      .then(() => {\r\n        // 重新寫入 pinia 與 storage 的資料\r\n        Object.entries(modifiedValue).forEach(\r\n          (item) => (store.userInfo[item[0]] = item[1])\r\n        );\r\n        store.userInfo.mode === 'session'\r\n          ? store.userInfoToSessionStorage()\r\n          : store.userInfoToLocalStorage();\r\n\r\n        createToast(\r\n          {\r\n            title: '修改成功',\r\n          },\r\n          {\r\n            type: 'success',\r\n            position: 'top-center',\r\n            timeout: 3000,\r\n            toastBackgroundColor: '#408560',\r\n            showIcon: 'true',\r\n            transition: 'zoom',\r\n          }\r\n        );\r\n      })\r\n      .catch(() => console.error('API 好像掛了，真是抱歉!!!'));\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  info.email = store.userInfo.email;\r\n  info.nickname = store.userInfo.nickname;\r\n  info.pic = store.userInfo.pic;\r\n  tempModifiedInfo.nickname = store.userInfo.nickname;\r\n});\r\n</script>\r\n","import script from \"./SettingView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SettingView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["route","useRoute","breadcrumb","ref","onMounted","value","meta","__exports__","store","useStore","newPasswordCheck","info","reactive","modalStatus","nicknameStatus","modalContent","api","axios","baseURL","process","tempModifiedInfo","nickname","pic","oldPassword","newPassword","modifiedInfo","modified","newValue","password","currentPic","computed","userInfo","require","nothingModified","Object","values","every","item","changeNickname","changePassword","showModal","changePicture","checkPassword","length","status","classList","remove","document","querySelector","removeAttribute","add","setAttribute","checkRepeatNickname","get","then","res","data","catch","console","error","toggleMask","closeModal","modalInit","modificationConfirm","id","createToast","title","description","type","position","timeout","toastBackgroundColor","showIcon","transition","modificationSubmit","modifiedValue","patch","entries","forEach","mode","userInfoToSessionStorage","userInfoToLocalStorage","email"],"sourceRoot":""}